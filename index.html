<!DOCTYPE html>
<html>
<head>
    <title>å­¦ç”Ÿå§“åéšæœºæ’åºï¼ˆå¸¦Wordå¯¼å‡ºï¼‰</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .input-area {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-size: 16px;
        }
        .buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            flex: 1;
        }
        #startBtn {
            background-color: #4CAF50;
            color: white;
        }
        #startBtn:hover {
            background-color: #45a049;
        }
        #stopBtn {
            background-color: #f44336;
            color: white;
            display: none;
        }
        #stopBtn:hover {
            background-color: #d32f2f;
        }
        #resetBtn {
            background-color: #2196F3;
            color: white;
        }
        #resetBtn:hover {
            background-color: #0b7dda;
        }
        #exportBtn {
            background-color: #FF9800;
            color: white;
        }
        #exportBtn:hover {
            background-color: #e68a00;
        }
        .animation-area {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            min-height: 100px;
            margin-bottom: 20px;
            text-align: center;
        }
        #shufflingName {
            font-size: 24px;
            font-weight: bold;
            color: #FF5722;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .result-area {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .result-item {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            font-size: 18px;
        }
        .result-item:last-child {
            border-bottom: none;
        }
        .export-area {
            margin-top: 15px;
            text-align: center;
        }
        .instructions {
            font-size: 14px;
            color: #666;
            margin-top: 20px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ å­¦ç”Ÿå§“åéšæœºæ’åº</h1>
    
    <div class="input-area">
        <p>è¯·è¾“å…¥å­¦ç”Ÿå§“åï¼Œæ¯è¡Œä¸€ä¸ªï¼š</p>
        <textarea id="names" placeholder="ä¾‹å¦‚ï¼š&#10;å¼ ä¸‰&#10;æå››&#10;ç‹äº”&#10;èµµå…­&#10;..."></textarea>
        
        <div class="buttons">
            <button id="startBtn" onclick="startShuffling()">å¼€å§‹éšæœº</button>
            <button id="stopBtn" onclick="stopShuffling()">åœæ­¢å¹¶æ’åº</button>
            <button id="resetBtn" onclick="resetAll()">é‡ç½®</button>
        </div>
    </div>
    
    <div class="animation-area">
        <div id="shufflingName">å‡†å¤‡å¼€å§‹...</div>
    </div>
    
    <div class="result-area" id="resultArea" style="display: none;">
        <h3>ğŸ‰ éšæœºæ’åºç»“æœï¼š</h3>
        <div id="resultList"></div>
        
        <div class="export-area">
            <button id="exportBtn" onclick="exportToWord()">å¯¼å‡ºä¸ºWordæ–‡æ¡£</button>
        </div>
    </div>
    
    <div class="instructions">
        <p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
        <ol>
            <li>åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥å­¦ç”Ÿå§“åï¼Œæ¯è¡Œä¸€ä¸ª</li>
            <li>ç‚¹å‡»"å¼€å§‹éšæœº"æŒ‰é’®å¼€å§‹éšæœºé—ªåŠ¨åå­—</li>
            <li>ç‚¹å‡»"åœæ­¢å¹¶æ’åº"æŒ‰é’®åœæ­¢å¹¶æ˜¾ç¤ºæœ€ç»ˆæ’åºç»“æœ</li>
            <li>ç‚¹å‡»"å¯¼å‡ºä¸ºWordæ–‡æ¡£"æŒ‰é’®ä¸‹è½½æ’åºç»“æœ</li>
            <li>ç‚¹å‡»"é‡ç½®"æŒ‰é’®å¯ä»¥é‡æ–°å¼€å§‹</li>
        </ol>
    </div>

    <script>
        let names = [];
        let shufflingInterval;
        let isShuffling = false;
        const shufflingSpeed = 100; // é—ªåŠ¨é€Ÿåº¦(æ¯«ç§’)
        
        // å¼€å§‹éšæœºé—ªåŠ¨
        function startShuffling() {
            // è·å–è¾“å…¥çš„åå­—
            const namesText = document.getElementById('names').value;
            names = namesText.split('\n').filter(name => name.trim() !== '');
            
            if (names.length === 0) {
                alert('è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå­¦ç”Ÿå§“åï¼');
                return;
            }
            
            // æ˜¾ç¤ºåŠ¨ç”»åŒºåŸŸ
            document.getElementById('shufflingName').textContent = "å‡†å¤‡å¼€å§‹...";
            
            // åˆ‡æ¢æŒ‰é’®çŠ¶æ€
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'block';
            
            // éšè—ä¹‹å‰çš„ç»“æœ
            document.getElementById('resultArea').style.display = 'none';
            
            // å¼€å§‹éšæœºé—ªåŠ¨
            isShuffling = true;
            let counter = 0;
            
            shufflingInterval = setInterval(() => {
                if (!isShuffling) return;
                
                // éšæœºé€‰æ‹©ä¸€ä¸ªåå­—æ˜¾ç¤º
                const randomIndex = Math.floor(Math.random() * names.length);
                document.getElementById('shufflingName').textContent = names[randomIndex];
                
                // æ·»åŠ ä¸€äº›è§†è§‰æ•ˆæœ
                counter++;
                const element = document.getElementById('shufflingName');
                element.style.transform = `scale(${1 + Math.sin(counter/5) * 0.1})`;
                element.style.color = `hsl(${counter % 360}, 80%, 50%)`;
                
            }, shufflingSpeed);
        }
        
        // åœæ­¢éšæœºå¹¶æ˜¾ç¤ºç»“æœ
        function stopShuffling() {
            if (!isShuffling) return;
            
            // åœæ­¢åŠ¨ç”»
            clearInterval(shufflingInterval);
            isShuffling = false;
            
            // åˆ‡æ¢æŒ‰é’®çŠ¶æ€
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('stopBtn').style.display = 'none';
            
            // æ‰§è¡Œæœ€ç»ˆéšæœºæ’åº
            shuffleNames();
        }
        
        // éšæœºæ’åºç®—æ³•
        function shuffleNames() {
            // æ´—ç‰Œç®—æ³• (Fisher-Yates)
            for (let i = names.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [names[i], names[j]] = [names[j], names[i]];
            }
            
            // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
            displayResult();
        }
        
        // æ˜¾ç¤ºæ’åºç»“æœ
        function displayResult() {
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = '';
            
            names.forEach((name, index) => {
                const item = document.createElement('div');
                item.className = 'result-item';
                item.textContent = `${index + 1}. ${name}`;
                resultList.appendChild(item);
            });
            
            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('shufflingName').textContent = "æ’åºå®Œæˆï¼";
            document.getElementById('shufflingName').style.color = '#4CAF50';
            document.getElementById('shufflingName').style.transform = 'scale(1)';
        }
        
        // é‡ç½®æ‰€æœ‰å†…å®¹
        function resetAll() {
            // åœæ­¢ä»»ä½•æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»
            clearInterval(shufflingInterval);
            isShuffling = false;
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('stopBtn').style.display = 'none';
            
            // é‡ç½®æ˜¾ç¤ºåŒºåŸŸ
            document.getElementById('shufflingName').textContent = "å‡†å¤‡å¼€å§‹...";
            document.getElementById('shufflingName').style.color = '#FF5722';
            document.getElementById('shufflingName').style.transform = 'scale(1)';
            
            // éšè—ç»“æœåŒºåŸŸ
            document.getElementById('resultArea').style.display = 'none';
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('names').value = '';
        }
        
        // å¯¼å‡ºä¸ºWordæ–‡æ¡£
        function exportToWord() {
            if (names.length === 0) {
                alert('æ²¡æœ‰å¯å¯¼å‡ºçš„æ•°æ®ï¼');
                return;
            }
            
            // åˆ›å»ºWordæ–‡æ¡£å†…å®¹
            let content = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" 
                      xmlns:w="urn:schemas-microsoft-com:office:word" 
                      xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="UTF-8">
                    <title>å­¦ç”Ÿéšæœºæ’åºç»“æœ</title>
                    <style>
                        body { font-family: "Microsoft YaHei", Arial, sans-serif; }
                        h1 { color: #2E74B5; text-align: center; }
                        table { width: 100%; border-collapse: collapse; }
                        th { background-color: #2E74B5; color: white; padding: 10px; }
                        td { padding: 8px; border: 1px solid #ddd; }
                        .odd { background-color: #f2f2f2; }
                        .info { margin-top: 30px; font-size: 12px; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>å­¦ç”Ÿéšæœºæ’åºç»“æœ</h1>
                    <p>ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString()}</p>
                    <table>
                        <tr>
                            <th>åºå·</th>
                            <th>å­¦ç”Ÿå§“å</th>
                        </tr>
            `;
            
            // æ·»åŠ å­¦ç”Ÿæ•°æ®
            names.forEach((name, index) => {
                const rowClass = index % 2 === 0 ? '' : 'class="odd"';
                content += `
                    <tr ${rowClass}>
                        <td>${index + 1}</td>
                        <td>${name}</td>
                    </tr>
                `;
            });
            
            content += `
                    </table>
                    <div class="info">
                        <p>æœ¬æ–‡ä»¶ç”±å­¦ç”Ÿå§“åéšæœºæ’åºå·¥å…·ç”Ÿæˆ</p>
                    </div>
                </body>
                </html>
            `;
            
            // åˆ›å»ºBlobå¯¹è±¡
            const blob = new Blob(['\ufeff', content], {
                type: 'application/msword'
            });
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `å­¦ç”Ÿéšæœºæ’åº_${new Date().toISOString().slice(0, 10)}.doc`;
            
            // è§¦å‘ä¸‹è½½
            document.body.appendChild(link);
            link.click();
            
            // æ¸…ç†
            setTimeout(() => {
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            }, 100);
        }
    </script>
</body>
</html>